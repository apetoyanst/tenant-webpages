(()=>{"use strict";var e,t={554:function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.DniResolver=void 0;var o=n(923),i="state",s="--test--",u=function(){return window.dni&&window.dni.q||[]},c=function(){function e(e){this.session=e;try{this.init()}catch(e){console.error(e)}}return Object.defineProperty(e.prototype,"result",{set:function(e){window.stDniResult=e},enumerable:!1,configurable:!0}),e.create=function(t){return new e(t)},e.getConfig=function(){return u().reduce((function(e,t){var n=t[0],o=t[1],i=t[2];return r(r(r({},e),"init"===n&&o?{tenantId:o}:{}),"init"===n&&i?{opts:r(r({},e.opts),i)}:{})}),{tenantId:"",opts:{api:"https://mads-dni.st.dev/api/dni"}})},e.prototype.init=function(){var e=this.session.get(i),t=o.parseQuery(location.search),n=t.gclid;return this.clickId=n,this.notifyInit(),e&&e.clickId===n?this.replacePhone(e.phoneToReplace,e.dni):n?this.resolveDni(t):void 0},e.prototype.resolveDni=function(t){var n=this,r=new XMLHttpRequest,i=location.hostname,s=e.getConfig(),u=s.tenantId,c=s.opts,a={ClickId:this.clickId,Properties:o.filterUtmParamsQuery(t)},l="?tenantId="+u+"&host="+i+"&api-version=2020-12-01";r.onreadystatechange=function(){if(4===r.readyState)if(r.status>=200&&r.status<300)try{n.resolveDniSuccess(JSON.parse(r.response))}catch(e){}else n.notifyError("error_response")},r.onerror=function(){n.notifyError("error_response")},r.open("POST",c.api+l),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.send(JSON.stringify(a))},e.prototype.resolveDniSuccess=function(e){if(!e.allocatedNumber||!e.defaultNumber)return this.notifyError("empty_response");this.clickId!==s&&this.session.set(i,{clickId:this.clickId,phoneToReplace:e.defaultNumber,dni:e.allocatedNumber}),this.replacePhone(e.defaultNumber,e.allocatedNumber)},e.prototype.replacePhone=function(e,t){var n=this,r=function(){o.replacePhoneInElement(document.body,e,t)?n.notifySuccess():n.notifyError("phone_not_found")};if(u().reduce((function(e,t){var n=t[0];return t[1],e||"load"===n||!1}),!1))return r();document.addEventListener("DOMContentLoaded",r,!1)},e.prototype.notifyInit=function(){this.clickId===s&&(this.result={progress:!0})},e.prototype.notifySuccess=function(){this.clickId===s&&(this.result={success:!0,code:"ok"})},e.prototype.notifyError=function(e){this.clickId===s&&(this.result={code:"script_"+e})},e}();t.DniResolver=c},777:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;var n=function(){function e(){}return e.key=function(e){return"st-dni-"+e},e.prototype.get=function(t){if(window.sessionStorage){var n=window.sessionStorage.getItem(e.key(t));if(null!==n)try{return JSON.parse(n)}catch(e){return}}},e.prototype.set=function(t,n){window.sessionStorage&&window.sessionStorage.setItem(e.key(t),JSON.stringify(n))},e}();t.Session=n},923:function(e,t){var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.filterUtmParamsQuery=t.parseQuery=t.replacePhoneInElement=t.replacePhoneNumberInText=t.findPhoneNumberInText=void 0;var r=new RegExp(/((?:1 |1|1.|1-)?\(?)(\d{3})((?:\)|.|-)? ?)(\d{3})(-| |.)?(\d{4})/);t.findPhoneNumberInText=function(e){r.lastIndex=0;var t=e.match(r);return t?[t[0],t[1]||"",t[2],t[3]||"",t[4],t[5]||"",t[6],t.index]:null},t.replacePhoneNumberInText=function(e,n,r){var o=t.findPhoneNumberInText(e);if(!o)return null;var i=o[0],s=o[1],u=o[2],c=o[3],a=o[4],l=o[5],f=o[6],p=o[7];return u+a+f!==n?null:e.substr(0,p)+s+r.substr(0,3)+c+r.substr(3,3)+l+r.substr(6,4)+e.substr(p+i.length)},t.replacePhoneInElement=function(e,n,r){if(e){var o=!1;if(e.children.length)for(var i=0;i<e.children.length;i++)o=t.replacePhoneInElement(e.children[i],n,r)||o;else(s=t.replacePhoneNumberInText(e.innerHTML,n,r))&&(e.innerHTML=s,o=!0);if("a"===e.tagName.toLowerCase()){var s,u=e;u.href&&"tel:"===u.href.substr(0,4)&&(s=t.replacePhoneNumberInText(u.href,n,r))&&(u.href=s,o=!0)}return o}},t.parseQuery=function(e){for(var t={},n=0,r=("?"===e[0]?e.substr(1):e).split("&");n<r.length;n++){var o=r[n].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]||"")}return t},t.filterUtmParamsQuery=function(e){return Object.keys(e).filter((function(e){return"utm_"===e.substr(0,4)})).reduce((function(t,r){var o;return n(n({},t),((o={})[r]=e[r],o))}),{})}}},n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}e=r(777),r(554).DniResolver.create(new e.Session)})();